@startuml
@startuml
skinparam actorStyle awesome
skinparam titleFontSize 32
title Sequence Diagram â€“ LineUpClassic Game (Human vs Computer Mode)

actor User as "Human Player"
participant Terminal
participant Program
participant GameController
participant IOController
participant GameConfig
participant LineUpClassic as Game
participant Grid
participant Human
participant Disc
participant Computer as IComputerStrategy

== Game Initialisation ==
User -> Program: Open game
loop while IsMenuActive == true
activate GameController
Program -> GameController: Start()
GameController -> IOController: PrintMenu()
activate IOController
IOController -> Terminal: return menu display
User -> IOController: input (1 - NewGame)
GameController -> GameController: RunCommand()
activate GameController
GameController -> GameController: NewGame()
deactivate GameController
GameController -> IOCController: GetInputNewGame()
IOController -> Terminal: PrintBannerNewGame()
User -> IOController: Select "LineUpClassic", "HvC", "No"
activate GameConfig
IOController -> GameConfig: SetGameMode()
IOController -> GameConfig: SetPlayerMode()
IOController -> GameConfig: SetGridHeight()
IOController -> GameConfig: SetGridWidth()
GameConfig -> IOController: return config
deactivate GameConfig
== Start Game Loop ==
activate Game
IOController -> GameController: return config
GameController -> Game: GameFactory(config)
GameController -> Game: GameLoop()
deactivate GameController
    loop While IsGameActive == true
    Game -> Terminal: PrintPlayerData()
    Game -> Grid: DrawGrid()
    Grid -> Terminal: return grid
    alt Human Player Turn
        Game -> Game: PlayerTurn(PlayerOne)
        activate Game
        deactivate Game
        Game -> User: GetInputGame()
        alt Make move
            User -> Game: Enter move
            Game -> Disc: CreateDisc()
            Game --> Disc: HasDiscRemaining()
            activate Disc
            alt HasDiscRemaining() == true
                Disc -> Game: return disc
                activate Grid
                Game -> Grid: AddDisc(disc, lane)
                deactivate Grid
                Game -> Disc: ApplyEffects(Board, lane)
                opt EffectTriggered
                    activate Grid
                    Disc -> Grid: ApplyGravity()
                end
            else HasDiscRemaining() == false
                 activate IOControll
                 Game -> IOControll: PrintError()
                 IOControll -> Terminal: display error message
                 deactivate IOControll
            end
                deactivate Disc
            Game -> Grid: DrawGrid()
            Grid -> Terminal: return grid
            alt Is Tie Game
                Grid -> Grid: IsTieGame(PlayerOne, PlayerTwo)
                activate Grid
                deactivate Grid
                Grid -> Game: IsTieGame = true
                Game -> IOController: PrintWinner(P1)
                Game -> Game: IsGameActive = false
                activate Game
                deactivate Game
            else Winner Found
                Game -> Grid: CheckWinCondition()
                Grid -> Game: CheckWinCondition(P1) = true
                Game -> IOController: PrintWinner(P1)
                Game -> Game: IsGameActive = false
                activate Game
                deactivate Game
            else Continue Game
                Game -> Grid: CheckWinCondition()
                Grid -> Game: CheckWinCondition = false
                Game -> Grid: IncrementTurnCounter()
            deactivate Grid
            end
            Game -> Game: DocumentMove(move)
            activate Game
            deactivate Game
        else Help/Undo/Redo/Quit command
            Game -> Game: TryHandleCommand()
            activate Game
            deactivate Game
        end
    else Computer Player Turn
        Game -> Game: PlayerTurn(PlayerTwo)
        activate Game
        deactivate Game
        activate IComputerStrategy
        Game -> IComputerStrategy: SelectMove()
        IComputerStrategy --> Game: Move{Disc, Lane}
        deactivate IComputerStrategy
        activate Disc
        Game -> Disc: CreateDisc()
        Disc -> Game: disc
        activate Grid
        Game -> Grid: AddDisc(disc, lane)
        Game -> Disc: ApplyEffects(Board, lane)
        opt EffectTriggered
            Disc -> Grid: ApplyGravity()
        end
        deactivate Disc
        alt Is Tie Game
            Grid -> Grid: IsTieGame(PlayerOne, PlayerTwo)
            activate Grid
            deactivate Grid
            Grid -> Game: IsTieGame = true
            Game -> IOController: PrintWinner(P2)
            Game -> Game: IsGameActive = false
            activate Game
            deactivate Game
        else Winner Found
            Game -> Grid: CheckWinCondition()
            Grid -> Game: CheckWinCondition(P2) = true
            Grid -> IOController: PrintWinner(P2)
            Game -> Game: IsGameActive = false
            activate Game
            deactivate Game
        else Continue Game
            Game -> Grid: CheckWinCondition()
            Grid -> Game: CheckWinCondition = false
            Game -> Grid: IncrementTurnCounter()
        deactivate Grid
        end
        Game -> Game: DocumentMove(move)
        activate Game
        deactivate Game
    end
deactivate Game
end
end
== Game Over ==
@enduml
